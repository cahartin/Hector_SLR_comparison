geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error))
```{r}
rcp45 <- read.csv("sample_outputstream_rcp45.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr") %>%
mutate(SLR = value - 35.36)
rcp60 <- read.csv("sample_outputstream_rcp60.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr") %>%
mutate(SLR = value - 35.36)
rcp85 <- read.csv("sample_outputstream_rcp85.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr") %>%
mutate(SLR = value - 35.36)
df <- rbind(rcp26, rcp45, rcp60, rcp85) %>%
mutate(SLR = SLR*10) %>%
filter(year < 2101) %>%
filter(year > 1849)
library(ggplot2)
library(dplyr)
setwd("C:/Users/chartin/OneDrive - Environmental Protection Agency (EPA)/Documents/GitHub/Hector_SLR_comparison/")
obs <- read.csv("CSIRO_Recons_gmsl_yr_2015.csv", sep = ",") %>%
rename("SLR" = "GMSL..mm.") %>%
rename("Error" = "GMSL.uncertainty..mm.") %>%
rename("year" = "Time") %>%
mutate(run_name = "observations")
ggplot(obs, aes(x=year, y=SLR)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error))
rcp26 <- read.csv("sample_outputstream_rcp26.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr") %>%
mutate(SLR = value - 35.36)
# filter(rcp26, year == 1990)
rcp45 <- read.csv("sample_outputstream_rcp45.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr") %>%
mutate(SLR = value - 35.36)
rcp60 <- read.csv("sample_outputstream_rcp60.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr") %>%
mutate(SLR = value - 35.36)
rcp85 <- read.csv("sample_outputstream_rcp85.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr") %>%
mutate(SLR = value - 35.36)
df <- rbind(rcp26, rcp45, rcp60, rcp85) %>%
mutate(SLR = SLR*10) %>%
filter(year < 2101) %>%
filter(year > 1849)
#merge obs with df
df2 <- full_join(df, obs)
ggplot(df2, aes(x=year, y=SLR, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error))
ggplot(df2, aes(x=year, y=SLR, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error))
ggplot(df2, aes(x=year, y=SLR, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error)) +
xlim(1850:2015)
ggplot(df2, aes(x=year, y=SLR, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error)) +
xlim(1850,2015)
ggplot(df2, aes(x=year, y=SLR, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error)) +
xlim(1850,2015)+
ylim(-250,250)
#merge obs with df
df2 <- full_join(df, obs)
ggplot(df2, aes(x=year, y=SLR, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error)) +
xlim(1850,2015)+
ylim(-250,250)
ggplot(df2, aes(x=year, y=SLR, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error))
head(df2)
meters <- mutate(df2, df2$SLR = SLR/1000)
meters <- mutate(df2, df2 = SLR/1000)
View(meters)
ggplot(df2, aes(x=year, y=df2, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error))
headggplot(meters, aes(x=year, y=df2, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error))
ggplot(meters, aes(x=year, y=df2, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error))
ggplot(df2, aes(x=year, y=SLR, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error))
df3<- mutate(df2$SLR = df2$SLR/100)
ggplot(df2, aes(x=year, y=SLR, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error)) +
geom_segment(aes(x = 2100, y = 520, xend = 2100, yend = 980))
View(rcp85)
head(df)
head(df2)
df3 <- mutate(df2, SLR_m = SLR/100)
head(df3)
max(df3$SLR_m)
df3 <- mutate(df2, SLR_m = SLR/1000)
max(df3$SLR_m)
ggplot(df3, aes(x=year, y=SLR, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error)) +
geom_segment(aes(x = 2100, y = 520, xend = 2100, yend = 980))
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point()+
geom_segment(aes(x = 2100, y = 520, xend = 2100, yend = 980))
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point()
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point() +
geom_segment(aes(x = 2100, y = .25, xend = 2100, yend = 0.6))
avg <- summerize(filter(df3, year %in% 1985:2005), avg_SLR = mean(SLR_m))
??summerize
avg <- summerise(filter(df3, year %in% 1985:2005), avg_SLR = mean(SLR_m))
avg <- summarise(filter(df3, year %in% 1985:2005), avg_SLR = mean(SLR_m))
View(avg)
View(df3)
library(ggplot2)
library(dplyr)
setwd("C:/Users/chartin/OneDrive - Environmental Protection Agency (EPA)/Documents/GitHub/Hector_SLR_comparison/")
obs <- read.csv("CSIRO_Recons_gmsl_yr_2015.csv", sep = ",") %>%
rename("SLR" = "GMSL..mm.") %>%
rename("Error" = "GMSL.uncertainty..mm.") %>%
rename("year" = "Time") %>%
mutate(run_name = "observations")
ggplot(obs, aes(x=year, y=SLR)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error))
rcp26 <- read.csv("sample_outputstream_rcp26.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "SLR")
rcp45 <- read.csv("sample_outputstream_rcp45.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "SLR")
rcp60 <- read.csv("sample_outputstream_rcp60.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "SLR")
rcp85 <- read.csv("sample_outputstream_rcp85.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "SLR")
df <- rbind(rcp26, rcp45, rcp60, rcp85) %>%
mutate(SLR = SLR*10) %>%
filter(year < 2101) %>%
filter(year > 1849)
df <- rbind(rcp26, rcp45, rcp60, rcp85) %>%
mutate(SLR = SLR*10) %>%
filter(year < 2101) %>%
filter(year > 1849) %>%
filter(variable == "SLR")
rcp26 <- read.csv("sample_outputstream_rcp26.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849)
View(rcp26)
rcp26 <- read.csv("sample_outputstream_rcp26.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
rcp45 <- read.csv("sample_outputstream_rcp45.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
rcp60 <- read.csv("sample_outputstream_rcp60.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
rcp85 <- read.csv("sample_outputstream_rcp85.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
df <- rbind(rcp26, rcp45, rcp60, rcp85) %>%
mutate(SLR = SLR*10) %>%
filter(year < 2101) %>%
filter(year > 1849)
df <- rbind(rcp26, rcp45, rcp60, rcp85) %>%
mutate(slr_mm = slr*10) %>%
filter(year < 2101) %>%
filter(year > 1849)
head(df)
df <- rbind(rcp26, rcp45, rcp60, rcp85)
View(df)
df <- rbind(rcp26, rcp45, rcp60, rcp85) %>%
mutate(slr_mm = value*10)
head(df)
df <- rbind(rcp26, rcp45, rcp60, rcp85) %>%
mutate(slr_mm = value*10) %>%
filter(year < 2101) %>%
filter(year > 1849)
df <- summarise(filter(df, year %in% 1990), avg_SLR = mean(SLR_mm))
df <- summarise(filter(df, year %in% 1990), avg_SLR = mean(slr_mm))
head(df)
df <- rbind(rcp26, rcp45, rcp60, rcp85) %>%
mutate(slr_mm = value*10) %>%
filter(year < 2101) %>%
filter(year > 1849)
avg <- summarise(filter(df, year %in% 1990), avg_SLR = mean(slr_mm))
head(df)
df <- mutate(df, slr_avg = slr_mm - avg)
head(df)
avg
head(obs)
df2 <- full_join(df, obs)
ggplot(df2, aes(x=year, y=SLR, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error)) +
xlim(1850,2015)+
ylim(-250,250)
head(df2)
head(df)
avg
df <- mutate(df, slr_avg = SLR - avg)
df <- mutate(df, SLR = slr_mm - avg)
head(df)
df <- mutate(df, SLR = slr_mm - avg)
head(df)
head(obs)
setwd("C:/Users/chartin/OneDrive - Environmental Protection Agency (EPA)/Documents/GitHub/Hector_SLR_comparison/")
obs <- read.csv("CSIRO_Recons_gmsl_yr_2015.csv", sep = ",") %>%
rename("SLR" = "GMSL..mm.") %>%
rename("Error" = "GMSL.uncertainty..mm.") %>%
rename("year" = "Time") %>%
mutate(run_name = "observations")
ggplot(obs, aes(x=year, y=SLR)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error))
rcp26 <- read.csv("sample_outputstream_rcp26.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
rcp45 <- read.csv("sample_outputstream_rcp45.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
rcp60 <- read.csv("sample_outputstream_rcp60.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
rcp85 <- read.csv("sample_outputstream_rcp85.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
df <- rbind(rcp26, rcp45, rcp60, rcp85) %>%
mutate(slr_mm = value*10) %>%
filter(year < 2101) %>%
filter(year > 1849)
head(df)
avg <- summarise(filter(df, year %in% 1990), SLR = mean(slr_mm))
avg
avg/1000
df <- mutate(df, SLR = slr_mm - avg)
head(df)
df2 <- full_join(df, obs)
head(obs)
df2 <- left_join(df, obs)
df2 <- right_join(df, obs)
df2 <- full_join(df, obs)
setwd("C:/Users/chartin/OneDrive - Environmental Protection Agency (EPA)/Documents/GitHub/Hector_SLR_comparison/")
obs <- read.csv("CSIRO_Recons_gmsl_yr_2015.csv", sep = ",") %>%
rename("SLR" = "GMSL..mm.") %>%
rename("Error" = "GMSL.uncertainty..mm.") %>%
rename("year" = "Time") %>%
mutate(run_name = "observations")
ggplot(obs, aes(x=year, y=SLR)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error))
rcp26 <- read.csv("sample_outputstream_rcp26.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
rcp45 <- read.csv("sample_outputstream_rcp45.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
rcp60 <- read.csv("sample_outputstream_rcp60.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
rcp85 <- read.csv("sample_outputstream_rcp85.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
df <- rbind(rcp26, rcp45, rcp60, rcp85) %>%
mutate(slr_mm = value*10) %>%
filter(year < 2101) %>%
filter(year > 1849)
avg <- as.numeric(summarise(filter(df, year %in% 1990), SLR = mean(slr_mm)))
df <- mutate(df, SLR = slr_mm - avg)
head(df)
head(obs)
df2 <- full_join(df, obs)
head(df2)
ggplot(df2, aes(x=year, y=SLR, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error)) +
xlim(1850,2015)+
ylim(-250,250)
df3 <- mutate(df2, SLR_m = slr_mm/1000)
head(df3)
# compute average SLR 1850-2005s
avg <- summarise(filter(df3, year %in% 1985:2005), avg_SLR = mean(SLR_m))
avg
df3 <- mutate(df3, SLR_m = SLR_m - avg)
head(df3)
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point() +
geom_segment(aes(x = 2100, y = .25, xend = 2100, yend = 0.6)) +
geom_segment(aes(x = 2100, y = .55, xend = 2100, yend = 1.0))
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point()
df3 <- mutate(df3, SLR_m = SLR_m - avg) %>%
select(-Error)
head(df3)
ggplot(df3, aes(x=year, y=avg_SLR, color = run_name)) +
geom_line()
View(df3)
library(ggplot2)
library(dplyr)
setwd("C:/Users/chartin/OneDrive - Environmental Protection Agency (EPA)/Documents/GitHub/Hector_SLR_comparison/")
obs <- read.csv("CSIRO_Recons_gmsl_yr_2015.csv", sep = ",") %>%
rename("SLR" = "GMSL..mm.") %>%
rename("Error" = "GMSL.uncertainty..mm.") %>%
rename("year" = "Time") %>%
mutate(run_name = "observations")
ggplot(obs, aes(x=year, y=SLR)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error))
rcp26 <- read.csv("sample_outputstream_rcp26.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
rcp45 <- read.csv("sample_outputstream_rcp45.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
rcp60 <- read.csv("sample_outputstream_rcp60.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
rcp85 <- read.csv("sample_outputstream_rcp85.csv", sep = ",", skip = 1) %>%
select(-component) %>%
filter(year > 1849) %>%
filter(variable == "slr")
df <- rbind(rcp26, rcp45, rcp60, rcp85) %>%
mutate(slr_mm = value*10) %>%
filter(year < 2101) %>%
filter(year > 1849)
avg <- as.numeric(summarise(filter(df, year %in% 1990), SLR = mean(slr_mm)))
df <- mutate(df, SLR = slr_mm - avg)
df3 <- mutate(df2, SLR_m = slr_mm/1000)
df2 <- full_join(df, obs)
ggplot(df2, aes(x=year, y=SLR, color = run_name)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=SLR-Error, ymax=SLR+Error)) +
xlim(1850,2015)+
ylim(-250,250)
df3 <- mutate(df2, SLR_m = slr_mm/1000)
# compute average SLR 1850-2005s
avg <- as.numeric(summarise(filter(df3, year %in% 1985:2005), SLR_m = mean(SLR_m)))
head(df3)
df3 <- mutate(df3, SLR_m = SLR_m - avg) %>%
select(-Error)
head(df3)
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line()
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point() +
geom_segment(aes(x = 2100, y = .25, xend = 2100, yend = 0.6)) +
geom_segment(aes(x = 2100, y = .55, xend = 2100, yend = 1.0))
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point() +
geom_segment(aes(x = 2100, y = .25, xend = 2100, yend = 0.6, color = green)) +
geom_segment(aes(x = 2100, y = .55, xend = 2105, yend = 1.0, color = blue))
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point() +
geom_segment(aes(x = 2100, y = .25, xend = 2100, yend = 0.6, color = black)) +
geom_segment(aes(x = 2100, y = .55, xend = 2105, yend = 1.0, color = blue))
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point() +
geom_segment(aes(x = 2100, y = .25, xend = 2100, yend = 0.6, color = "black")) +
geom_segment(aes(x = 2100, y = .55, xend = 2105, yend = 1.0, color = "blue"))
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point() +
geom_segment(aes(x = 2100, y = .25, xend = 2100, yend = 0.6, color = "black")) +
geom_segment(aes(x = 2105, y = .55, xend = 2105, yend = 1.0, color = "blue"))
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point() +
geom_segment(aes(x = 2100, y = .25, xend = 2100, yend = 0.6), color = "black") +
geom_segment(aes(x = 2105, y = .55, xend = 2105, yend = 1.0), color = "blue")
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point() +
geom_segment(aes(x = 2100, y = .55, xend = 2100, yend = 0.85), color = "black") +
geom_segment(aes(x = 2100, y = .8, xend = 2100, yend = 1.25), color = "blue")
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point() +
geom_segment(aes(x = 2100, y = .55, xend = 2100, yend = 0.85), color = "black") +
geom_segment(aes(x = 2105, y = .8, xend = 2105, yend = 1.25), color = "blue")
![Caption for the picture.]("C:/Users/chartin/OneDrive - Environmental Protection Agency (EPA)/Profile/Pictures/WGI_AR5_Fig13-27.jpg")
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point() +
geom_segment(aes(x = 2100, y = .55, xend = 2100, yend = 0.85), color = "black") +
geom_segment(aes(x = 2105, y = .8, xend = 2105, yend = 1.25), color = "blue") +
xlim(1950, 2010)
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point() +
geom_segment(aes(x = 2100, y = .55, xend = 2100, yend = 0.85), color = "black") +
geom_segment(aes(x = 2105, y = .8, xend = 2105, yend = 1.25), color = "blue") +
xlim(1950, 2110)
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point() +
geom_segment(aes(x = 2100, y = .55, xend = 2100, yend = 0.85), color = "black") +
geom_segment(aes(x = 2105, y = .8, xend = 2105, yend = 1.25), color = "blue") +
xlim(2000, 2110)
ggplot(df3, aes(x=year, y=SLR_m, color = run_name)) +
geom_line() +
geom_point() +
geom_segment(aes(x = 2100, y = .55, xend = 2100, yend = 0.85), color = "blue") +
geom_segment(aes(x = 2105, y = .8, xend = 2105, yend = 1.25), color = "red") +
xlim(2000, 2110)
library(devtools)
library(ggplot2)
library(dplyr)
library(tidyr)
library(knitr)
#Units are in MMmt need to convert to PGC
EIA_emis <- read.csv("C:/Users/chartin/OneDrive - Environmental Protection Agency (EPA)/Temp Binning/World_carbon_dioxide_emissions_by_region.csv", skip = 8, sep = ",") %>%
filter(OECD.Americas == "Total World") %>%
gather() %>%
slice(5:45)
EIA_emis$value <- as.numeric(as.character(EIA_emis$value))
year <- c(2010:2050)
year <- t(t(year))
EIA_emis <- cbind(EIA_emis,year) %>%
select(-key) %>%
mutate(value = ((value * 0.001) *(12/44))) %>%   # Convert from MMmtCO2 to GtC/year
rename("CO2_emissions" = "value") %>%
mutate(scenario = "EIA")
# compare GCAM emissions with EIA_emissions
gcam_emis <- read.csv("C:/Users/chartin/OneDrive - Environmental Protection Agency (EPA)/Documents/GitHub/hector/inst/input/emissions/gcam_v5.3_emissions.csv") %>%
select(Date, ffi_emissions) %>%
filter(Date < 2051) %>%
rename("year"= "Date") %>%
rename("CO2_emissions" = "ffi_emissions") %>%
mutate(scenario = "gcam")
emissions <- full_join(EIA_emis, gcam_emis)
devtools::load_all("C:/Users/chartin/OneDrive - Environmental Protection Agency (EPA)/Documents/GitHub/hector/")
library(hector)
ini_file <- system.file("input/hector_gcam_ref.ini", package="hector")
core<- newcore(ini_file)
core
run(core)
default_results <- fetchvars(core, 1850:2100)
ggplot(default_results) + aes(x = year, y = value, color = scenario) +
geom_line() +
facet_wrap(~variable, scales = "free_y")
